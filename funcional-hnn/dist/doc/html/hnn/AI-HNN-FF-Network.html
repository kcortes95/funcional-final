<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AI.HNN.FF.Network</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">hnn-0.3: A reasonably fast and simple neural network library</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) 2012 Alp Mestanogullari</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>alpmestan@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>GHC</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">AI.HNN.FF.Network</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Creating a neural network</a></li><li><a href="#g:3">Computing a neural network's output</a></li><li><a href="#g:4">Training a neural network</a></li><li><a href="#g:5">Loading and saving a neural network</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>An implementation of feed-forward neural networks in pure Haskell.</p><p>It uses weight matrices between each layer to represent the connections between neurons from
 a layer to the next and exports only the useful bits for a user of the library.</p><p>Here is an example of using this module to create a feed-forward neural network with 2 inputs,
 2 neurons in a hidden layer and one neuron in the output layer, with random weights, and compute
 its output for [1,2] using the sigmoid function for activation for all the neurons.</p><pre>import AI.HNN.FF.Network
import Numeric.LinearAlgebra

main = do
  n &lt;- createNetwork 2 [2] 1 :: IO (Network Double)
  print $ output n sigmoid (fromList [1, 1])</pre><p><em>Note</em>: Here, I create a <code>Network Double</code>, but you can replace <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Double" title="Prelude">Double</a></code> with any number type
 that implements the appropriate typeclasses you can see in the signatures of this module.
 Having your number type implement the <code>Floating</code> typeclass too is a good idea, since that's what most of the
 common activation functions require.</p><p><em>Note 2</em>: You can also give some precise weights to initialize the neural network with, with
 <code><a href="AI-HNN-FF-Network.html#v:fromWeightMatrices" title="AI.HNN.FF.Network">fromWeightMatrices</a></code>. You can also restore a neural network you had saved using <code><a href="AI-HNN-FF-Network.html#v:loadNetwork" title="AI.HNN.FF.Network">loadNetwork</a></code>.</p><p>Here is an example of how to train a neural network to learn the XOR function.
 ( for reference: XOR(0, 0) = 0, XOR(0, 1) = 1, XOR(1, 0) = 1, XOR(1, 1) = 0 )</p><p>First, let's import hnn's feedforward neural net module, and hmatrix's vector types.</p><pre>import AI.HNN.FF.Network
import Numeric.LinearAlgebra</pre><p>Now, we will specify our training set (what the net should try to learn).</p><pre>samples :: Samples Double
samples = [ fromList [0, 0] --&gt; fromList [0]
          , fromList [0, 1] --&gt; fromList [1]
          , fromList [1, 0] --&gt; fromList [1]
          , fromList [1, 1] --&gt; fromList [0] 
          ]</pre><p>You can see that this is basically a list of pairs of vectors, the first vector being
 the input given to the network, the second one being the expected output. Of course,
 this imply working on a neural network with 2 inputs, and a single neuron on the output layer. Then,
 let's create one!</p><pre>main = do
  net &lt;- createNetwork 2 [2] 1</pre><p>You may have noticed we haven't specified a signature this time, unlike in the earlier snippet.
 Since we gave a signature to samples, specifying we're working with <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Double" title="Prelude">Double</a></code> numbers, and since
 we are going to tie <code>net</code> and <code>samples</code> by a call to a learning function, GHC will gladly figure out
 that <code>net</code> is working with <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Double" title="Prelude">Double</a></code>. </p><p>Now, it's time to train our champion. But first, let's see how bad he is now. The weights are most likely
 not close to those that will give a good result for simulating XOR. Let's compute the output of the net on
 the input vectors of our samples, using <code><a href="AI-HNN-FF-Network.html#v:tanh" title="AI.HNN.FF.Network">tanh</a></code> as the activation function.</p><pre>  mapM_ (print . output net tanh . fst) samples</pre><p>Ok, you've tested this, and it gives terrible results. Let's fix this by letting <code><a href="AI-HNN-FF-Network.html#v:trainNTimes" title="AI.HNN.FF.Network">trainNTimes</a></code> teach our neural net
 how to behave. Since we're using <code><a href="AI-HNN-FF-Network.html#v:tanh" title="AI.HNN.FF.Network">tanh</a></code> as our activation function, we will tell it to the training function,
 and also specify its derivative.</p><pre>  let smartNet = trainNTimes 1000 0.8 tanh tanh' net samples</pre><p>So, this tiny piece of code will run the backpropagation algorithm on the samples 1000 times, with a learning rate
 of 0.8. The learning rate is basically how strongly we should modify the weights when we try to correct the error the net makes
 on our samples. The bigger it is, the more the weights are going to change significantly. Depending on the case, it can be good,
 but sometimes it can make the backprop algorithm oscillate around good weight values without actually getting to them.
 You usually want to test several values and see which ones get you the nicest neural net, which generalizes well to samples
 that are not in the training set while giving decent results on the training set.</p><p>Now, let's see how that worked out for us:</p><pre>  mapM_ (print . output smartNet tanh . fst) samples</pre><p>You could even save that neural network's weights to a file, so that you don't need to train it again in the future, using <code><a href="AI-HNN-FF-Network.html#v:saveNetwork" title="AI.HNN.FF.Network">saveNetwork</a></code>:</p><pre>  saveNetwork &quot;smartNet.nn&quot; smartNet</pre><p>Please note that <code><a href="AI-HNN-FF-Network.html#v:saveNetwork" title="AI.HNN.FF.Network">saveNetwork</a></code> is just a wrapper around zlib compression + serialization using the binary package.
 AI.HNN.FF.Network also provides a <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#t:Binary" title="Data.Binary">Binary</a></code> instance for <code><a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a></code>, which means you can also simply use
 <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#v:encode" title="Data.Binary">encode</a></code> and <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#v:decode" title="Data.Binary">decode</a></code> to have your own saving/restoring routines, or to simply get a bytestring 
 we can send over the network, for example.</p><p>Here's a run of the program we described on my machine (with the timing): first set of
 fromList's is the output of the initial neural network, the second one is the output of
 <code>smartNet</code> :-)</p><pre>fromList [0.574915179613429]
fromList [0.767589097192215]
fromList [0.7277396607146663]
fromList [0.8227114080561128]
------------------
fromList [6.763498312099933e-2]
fromList [0.9775186355284375]
fromList [0.9350823296850516]
fromList [-4.400205702560454e-2]

real    0m0.365s
user    0m0.072s
sys     0m0.016s</pre><p>Rejoyce! Feel free to play around with the library and report any bug, feature request and whatnot to us on
 our github repository <a href="https://github.com/alpmestan/hnn/issues">https://github.com/alpmestan/hnn/issues</a> using the appropriate tags. Also, you can
 see the simple program we studied here with pretty colors at <a href="https://github.com/alpmestan/hnn/blob/master/examples/ff/xor.hs">https://github.com/alpmestan/hnn/blob/master/examples/ff/xor.hs</a>
 and other ones at <a href="https://github.com/alpmestan/hnn/tree/master/examples/ff">https://github.com/alpmestan/hnn/tree/master/examples/ff</a>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">newtype</span> <a href="#t:Network">Network</a> a = <a href="#v:Network">Network</a> {<ul class="subs"><li><a href="#v:matrices">matrices</a> :: <a href="file:///Library/Haskell/ghc-8.4.3-x86_64/lib/vector-0.12.0.1/doc/html/Data-Vector.html#t:Vector" title="Data.Vector">Vector</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Matrix" title="Numeric.LinearAlgebra.Data">Matrix</a> a)</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:ActivationFunction">ActivationFunction</a> a = a -&gt; a</li><li class="src short"><span class="keyword">type</span> <a href="#t:ActivationFunctionDerivative">ActivationFunctionDerivative</a> a = a -&gt; a</li><li class="src short"><span class="keyword">type</span> <a href="#t:Sample">Sample</a> a = (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a)</li><li class="src short"><span class="keyword">type</span> <a href="#t:Samples">Samples</a> a = [<a href="AI-HNN-FF-Network.html#t:Sample" title="AI.HNN.FF.Network">Sample</a> a]</li><li class="src short"><a href="#v:-45--45--62-">(--&gt;)</a> :: <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a -&gt; <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Sample" title="AI.HNN.FF.Network">Sample</a> a</li><li class="src short"><a href="#v:createNetwork">createNetwork</a> :: (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/mwc-random-0.14.0.0/doc/html/System-Random-MWC.html#t:Variate" title="System.Random.MWC">Variate</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; [<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a>] -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a)</li><li class="src short"><a href="#v:fromWeightMatrices">fromWeightMatrices</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a =&gt; <a href="file:///Library/Haskell/ghc-8.4.3-x86_64/lib/vector-0.12.0.1/doc/html/Data-Vector.html#t:Vector" title="Data.Vector">Vector</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Matrix" title="Numeric.LinearAlgebra.Data">Matrix</a> a) -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a</li><li class="src short"><a href="#v:output">output</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a)) =&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a -&gt; <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a</li><li class="src short"><a href="#v:tanh">tanh</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a =&gt; a -&gt; a</li><li class="src short"><a href="#v:tanh-39-">tanh'</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a =&gt; a -&gt; a</li><li class="src short"><a href="#v:sigmoid">sigmoid</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a =&gt; a -&gt; a</li><li class="src short"><a href="#v:sigmoid-39-">sigmoid'</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a =&gt; a -&gt; a</li><li class="src short"><a href="#v:trainUntil">trainUntil</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Container" title="Numeric.LinearAlgebra">Container</a> <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a) =&gt; (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunctionDerivative" title="AI.HNN.FF.Network">ActivationFunctionDerivative</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a</li><li class="src short"><a href="#v:trainNTimes">trainNTimes</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Container" title="Numeric.LinearAlgebra">Container</a> <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunctionDerivative" title="AI.HNN.FF.Network">ActivationFunctionDerivative</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a</li><li class="src short"><a href="#v:trainUntilErrorBelow">trainUntilErrorBelow</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Normed" title="Numeric.LinearAlgebra">Normed</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Container" title="Numeric.LinearAlgebra">Container</a> <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:RealOf" title="Numeric.LinearAlgebra">RealOf</a> a), a ~ <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:RealOf" title="Numeric.LinearAlgebra">RealOf</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a) =&gt; a -&gt; a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunctionDerivative" title="AI.HNN.FF.Network">ActivationFunctionDerivative</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a</li><li class="src short"><a href="#v:quadError">quadError</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:RealOf" title="Numeric.LinearAlgebra">RealOf</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Normed" title="Numeric.LinearAlgebra">Normed</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a) =&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:RealOf" title="Numeric.LinearAlgebra">RealOf</a> a</li><li class="src short"><a href="#v:loadNetwork">loadNetwork</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Element" title="Numeric.LinearAlgebra">Element</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#t:Binary" title="Data.Binary">Binary</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a)</li><li class="src short"><a href="#v:saveNetwork">saveNetwork</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Element" title="Numeric.LinearAlgebra">Element</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#t:Binary" title="Data.Binary">Binary</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Types</h1></a><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Network" class="def">Network</a> a <a href="#t:Network" class="selflink">#</a></p><div class="doc"><p>Our feed-forward neural network type. Note the <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#t:Binary" title="Data.Binary">Binary</a></code> instance, which means you can use 
   <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#v:encode" title="Data.Binary">encode</a></code> and <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#v:decode" title="Data.Binary">decode</a></code> in case you need to serialize your neural nets somewhere else than
   in a file (e.g over the network)</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Network" class="def">Network</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:matrices" class="def">matrices</a> :: <a href="file:///Library/Haskell/ghc-8.4.3-x86_64/lib/vector-0.12.0.1/doc/html/Data-Vector.html#t:Vector" title="Data.Vector">Vector</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Matrix" title="Numeric.LinearAlgebra.Data">Matrix</a> a)</dfn><div class="doc"><p>the weight matrices</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:Network" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Network:Show:1"></span> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Element" title="Numeric.LinearAlgebra">Element</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a)</span> <a href="#t:Network" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Network:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="AI-HNN-FF-Network.html">AI.HNN.FF.Network</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a] -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Network:Binary:2"></span> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Element" title="Numeric.LinearAlgebra">Element</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#t:Binary" title="Data.Binary">Binary</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#t:Binary" title="Data.Binary">Binary</a> (<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a)</span> <a href="#t:Network" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Network:Binary:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="AI-HNN-FF-Network.html">AI.HNN.FF.Network</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:put">put</a> :: <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary-Put.html#t:Put" title="Data.Binary.Put">Put</a> <a href="#v:put" class="selflink">#</a></p><p class="src"><a href="#v:get">get</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary-Get-Internal.html#t:Get" title="Data.Binary.Get.Internal">Get</a> (<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a) <a href="#v:get" class="selflink">#</a></p><p class="src"><a href="#v:putList">putList</a> :: [<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a] -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary-Put.html#t:Put" title="Data.Binary.Put">Put</a> <a href="#v:putList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ActivationFunction" class="def">ActivationFunction</a> a = a -&gt; a <a href="#t:ActivationFunction" class="selflink">#</a></p><div class="doc"><p>The type of an activation function, mostly used for clarity in signatures</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ActivationFunctionDerivative" class="def">ActivationFunctionDerivative</a> a = a -&gt; a <a href="#t:ActivationFunctionDerivative" class="selflink">#</a></p><div class="doc"><p>The type of an activation function's derivative, mostly used for clarity in signatures</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Sample" class="def">Sample</a> a = (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a) <a href="#t:Sample" class="selflink">#</a></p><div class="doc"><p>Input vector and expected output vector</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Samples" class="def">Samples</a> a = [<a href="AI-HNN-FF-Network.html#t:Sample" title="AI.HNN.FF.Network">Sample</a> a] <a href="#t:Samples" class="selflink">#</a></p><div class="doc"><p>List of <code><a href="AI-HNN-FF-Network.html#t:Sample" title="AI.HNN.FF.Network">Sample</a></code>s</p></div></div><div class="top"><p class="src"><a id="v:-45--45--62-" class="def">(--&gt;)</a> :: <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a -&gt; <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Sample" title="AI.HNN.FF.Network">Sample</a> a <a href="#v:-45--45--62-" class="selflink">#</a></p><div class="doc"><p>Handy operator to describe your learning set, avoiding unnecessary parentheses. It's just a synonym for '(,)'. 
   Generally you'll load your learning set from a file, a database or something like that, but it can be nice for 
   quickly playing with hnn or for simple problems where you manually specify your learning set.
   That is, instead of writing:</p><pre>samples :: Samples Double
samples = [ (fromList [0, 0], fromList [0])
          , (fromList [0, 1], fromList [1])
          , (fromList [1, 0], fromList [1])
          , (fromList [1, 1], fromList [0]) 
          ]</pre><p>You can write:</p><pre>samples :: Samples Double
samples = [ fromList [0, 0] --&gt; fromList [0]
          , fromList [0, 1] --&gt; fromList [1]
          , fromList [1, 0] --&gt; fromList [1]
          , fromList [1, 1] --&gt; fromList [0] 
          ]</pre></div></div><a href="#g:2" id="g:2"><h1>Creating a neural network</h1></a><div class="top"><p class="src"><a id="v:createNetwork" class="def">createNetwork</a> :: (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/mwc-random-0.14.0.0/doc/html/System-Random-MWC.html#t:Variate" title="System.Random.MWC">Variate</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; [<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a>] -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a) <a href="#v:createNetwork" class="selflink">#</a></p><div class="doc"><p>The following creates a neural network with <code>n</code> inputs and if <code>l</code> is [n1, n2, ...]
   the net will have n1 neurons on the first layer, n2 neurons on the second, and so on
   ending with k neurons on the output layer, with random weight matrices as a courtesy of
 <code><a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/mwc-random-0.14.0.0/doc/html/System-Random-MWC.html#v:uniformVector" title="System.Random.MWC">uniformVector</a></code>.</p><pre>createNetwork n l k</pre></div></div><div class="top"><p class="src"><a id="v:fromWeightMatrices" class="def">fromWeightMatrices</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a =&gt; <a href="file:///Library/Haskell/ghc-8.4.3-x86_64/lib/vector-0.12.0.1/doc/html/Data-Vector.html#t:Vector" title="Data.Vector">Vector</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Matrix" title="Numeric.LinearAlgebra.Data">Matrix</a> a) -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a <a href="#v:fromWeightMatrices" class="selflink">#</a></p><div class="doc"><p>Creates a neural network with exactly the weight matrices given as input here.
   We don't check that the numbers of rows/columns are compatible, etc. </p></div></div><a href="#g:3" id="g:3"><h1>Computing a neural network's output</h1></a><div class="top"><p class="src"><a id="v:output" class="def">output</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a)) =&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a -&gt; <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a <a href="#v:output" class="selflink">#</a></p><div class="doc"><p>Computes the output of the network on the given input vector with the given activation function</p></div></div><div class="top"><p class="src"><a id="v:tanh" class="def">tanh</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a =&gt; a -&gt; a <a href="#v:tanh" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tanh-39-" class="def">tanh'</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a =&gt; a -&gt; a <a href="#v:tanh-39-" class="selflink">#</a></p><div class="doc"><p>Derivative of the <code><a href="AI-HNN-FF-Network.html#v:tanh" title="AI.HNN.FF.Network">tanh</a></code> function from the Prelude.</p></div></div><div class="top"><p class="src"><a id="v:sigmoid" class="def">sigmoid</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a =&gt; a -&gt; a <a href="#v:sigmoid" class="selflink">#</a></p><div class="doc"><p>The sigmoid function:  1 / (1 + exp (-x))</p></div></div><div class="top"><p class="src"><a id="v:sigmoid-39-" class="def">sigmoid'</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a =&gt; a -&gt; a <a href="#v:sigmoid-39-" class="selflink">#</a></p><div class="doc"><p>Derivative of the sigmoid function: sigmoid x * (1 - sigmoid x)</p></div></div><a href="#g:4" id="g:4"><h1>Training a neural network</h1></a><div class="top"><p class="src"><a id="v:trainUntil" class="def">trainUntil</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Container" title="Numeric.LinearAlgebra">Container</a> <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a) =&gt; (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunctionDerivative" title="AI.HNN.FF.Network">ActivationFunctionDerivative</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a <a href="#v:trainUntil" class="selflink">#</a></p><div class="doc"><p>Generic training function.</p><p>The first argument is a predicate that will tell the backpropagation algorithm when to stop.
 The first argument to the predicate is the epoch, i.e the number of times the backprop has been
 executed on the samples. The second argument is <em>the current network</em>, and the third is the list of samples.
 You can thus combine these arguments to create your own criterion.</p><p>For example, if you want to stop learning either when the network's quadratic error on the samples,
 using the tanh function, is below 0.01, or after 1000 epochs, whichever comes first, you could
 use the following predicate:</p><pre>pred epochs net samples = if epochs == 1000 then True else quadError tanh net samples &lt; 0.01</pre><p>You could even use <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Debug-Trace.html#v:trace" title="Debug.Trace">trace</a></code> to print the error, to see how the error evolves while it's learning,
 or redirect this to a file from your shell in order to generate a pretty graphics and what not.</p><p>The second argument (after the predicate) is the learning rate. Then come the activation function you want,
 its derivative, the initial neural network, and your training set.
 Note that we provide <code><a href="AI-HNN-FF-Network.html#v:trainNTimes" title="AI.HNN.FF.Network">trainNTimes</a></code> and <code><a href="AI-HNN-FF-Network.html#v:trainUntilErrorBelow" title="AI.HNN.FF.Network">trainUntilErrorBelow</a></code> for common use cases.</p></div></div><div class="top"><p class="src"><a id="v:trainNTimes" class="def">trainNTimes</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Container" title="Numeric.LinearAlgebra">Container</a> <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunctionDerivative" title="AI.HNN.FF.Network">ActivationFunctionDerivative</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a <a href="#v:trainNTimes" class="selflink">#</a></p><div class="doc"><p>Trains the neural network with backpropagation the number of times specified by the <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a></code> argument,
 using the given learning rate (second argument).                                   </p></div></div><div class="top"><p class="src"><a id="v:trainUntilErrorBelow" class="def">trainUntilErrorBelow</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Normed" title="Numeric.LinearAlgebra">Normed</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Container" title="Numeric.LinearAlgebra">Container</a> <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:RealOf" title="Numeric.LinearAlgebra">RealOf</a> a), a ~ <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:RealOf" title="Numeric.LinearAlgebra">RealOf</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a) =&gt; a -&gt; a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunctionDerivative" title="AI.HNN.FF.Network">ActivationFunctionDerivative</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a <a href="#v:trainUntilErrorBelow" class="selflink">#</a></p><div class="doc"><p>Trains the neural network until the quadratic error (<code><a href="AI-HNN-FF-Network.html#v:quadError" title="AI.HNN.FF.Network">quadError</a></code>) comes below the given value (first argument),
 using the given learning rate (second argument).</p><p><em>Note</em>: this can loop pretty much forever when you're using a bad architecture for the problem, or inappropriate activation
 functions.</p></div></div><div class="top"><p class="src"><a id="v:quadError" class="def">quadError</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:RealOf" title="Numeric.LinearAlgebra">RealOf</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Normed" title="Numeric.LinearAlgebra">Normed</a> (<a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra-Data.html#t:Vector" title="Numeric.LinearAlgebra.Data">Vector</a> a), <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Numeric" title="Numeric.LinearAlgebra">Numeric</a> a) =&gt; <a href="AI-HNN-FF-Network.html#t:ActivationFunction" title="AI.HNN.FF.Network">ActivationFunction</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="AI-HNN-FF-Network.html#t:Samples" title="AI.HNN.FF.Network">Samples</a> a -&gt; <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:RealOf" title="Numeric.LinearAlgebra">RealOf</a> a <a href="#v:quadError" class="selflink">#</a></p><div class="doc"><p>Quadratic error on the given training set using the given activation function. Useful to create
 your own predicates for <code><a href="AI-HNN-FF-Network.html#v:trainUntil" title="AI.HNN.FF.Network">trainUntil</a></code>.</p></div></div><a href="#g:5" id="g:5"><h1>Loading and saving a neural network</h1></a><div class="top"><p class="src"><a id="v:loadNetwork" class="def">loadNetwork</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Element" title="Numeric.LinearAlgebra">Element</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#t:Binary" title="Data.Binary">Binary</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a) <a href="#v:loadNetwork" class="selflink">#</a></p><div class="doc"><p>Loading a neural network from a file (uses zlib compression on top of serialization using the binary package).
   Will throw an exception if the file isn't there.</p></div></div><div class="top"><p class="src"><a id="v:saveNetwork" class="def">saveNetwork</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a, <a href="file:///Users/kevin/Library/Haskell/ghc-8.4.3-x86_64/lib/hmatrix-0.19.0.0/doc/html/Numeric-LinearAlgebra.html#t:Element" title="Numeric.LinearAlgebra">Element</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/binary-0.8.5.1/Data-Binary.html#t:Binary" title="Data.Binary">Binary</a> a) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="AI-HNN-FF-Network.html#t:Network" title="AI.HNN.FF.Network">Network</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/8.4.3-x86_64/usr/share/doc/ghc-8.4.3/html/libraries/base-4.11.1.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="#v:saveNetwork" class="selflink">#</a></p><div class="doc"><p>Saving a neural network to a file (uses zlib compression on top of serialization using the binary package).</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.20.0</p></div></body></html>